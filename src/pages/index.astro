---
import LanguageSwitcher from "../components/LanguagePicker.astro";
import Base from "../layouts/Base.astro";
import Experience from "../components/Experience.astro";
import Skills from "../components/Skills.astro";
import Projects from "../components/Projects.astro";
import Start from "../components/Start.astro";
import Wakatime from "../components/Wakatime.astro";
import Contact from "../components/Contact.astro";

---

<Base>
    <main
        class="h-screen overflow-y-scroll snap-y snap-mandatory scroll-smooth bg-black text-white"
        id="scroll-root"
    >
        <Start />

        <Projects />

        <Skills />

        <Experience />
        
        <Wakatime />

        <Contact />
    </main>

    <style is:global>
        /* Ocultar scrollbar */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        h1 {
            text-wrap: balance;
        }
    </style>

    <script>
        import { languages, getLang } from "../i18n";

        // --- 1. i18n ---
        const lang = getLang();
        const t = languages[lang];
        document.querySelectorAll("[data-i18n]").forEach((el) => {
            el.textContent = t[el.dataset.i18n] ?? el.dataset.i18n;
        });

        // --- 2. Animaciones de ApariciÃ³n General (Intro/Skills/Exp) ---
        const observer = new IntersectionObserver(
            (entries) => {
                entries.forEach((entry) => {
                    if (entry.isIntersecting) {
                        entry.target.classList.remove(
                            "opacity-0",
                            "translate-y-10",
                            "translate-y-12",
                        );
                    }
                });
            },
            { threshold: 0.3 },
        );
        document
            .querySelectorAll("[data-animate]")
            .forEach((el) => observer.observe(el));

        // --- 3. Parallax del Fondo (Scroll Vertical General) ---
        const root = document.getElementById("scroll-root");
        const parallaxItems = document.querySelectorAll("[data-parallax]");
        root.addEventListener("scroll", () => {
            const scrollTop = root.scrollTop;
            parallaxItems.forEach((el) => {
                const speed = Number(el.dataset.speed) || 0.2;
                el.style.transform = `translateY(${scrollTop * speed}px)`;
            });
        });
    </script>
</Base>
