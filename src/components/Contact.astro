<section
    id="contact"
    class="snap-start h-screen relative flex items-center bg-[#030303] light:bg-[#f9fafb] overflow-hidden transition-colors duration-700 will-change-[background-color]"
>
    <div
        class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] bg-indigo-600/5 light:bg-indigo-500/10 blur-[160px] rounded-full pointer-events-none transition-colors duration-700 theme-perf-target"
    >
    </div>

    <div class="container mx-auto px-6 md:px-12 relative z-10">
        <div
            class="opacity-0 translate-y-10 transition-all duration-1000 ease-out text-center md:text-left"
            data-animate
        >
            <div class="mb-16">
                <h4
                    data-i18n="contact_title"
                    class="text-indigo-400 light:text-indigo-600 font-mono text-xs uppercase tracking-[0.5em] mb-4 transition-colors duration-700"
                >
                </h4>
                <h2
                    data-i18n="contact_subtitle"
                    class="text-6xl md:text-9xl font-black tracking-tighter text-white light:text-gray-900 transition-colors duration-700"
                >
                </h2>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div
                    class="md:col-span-2 group relative p-[1px] rounded-3xl overflow-hidden bg-white/5 light:bg-white border border-white/10 light:border-black/5 backdrop-blur-xl transition-all duration-700 hover:border-indigo-500/50 light:shadow-xl light:shadow-black/5"
                >
                    <div
                        class="p-8 md:p-12 flex flex-col justify-between h-full"
                    >
                        <div>
                            <span
                                class="text-gray-500 light:text-gray-400 font-mono text-xs uppercase tracking-widest transition-colors duration-700"
                                >Email</span
                            >
                            <h3
                                id="email-text"
                                class="text-2xl md:text-4xl font-bold text-white light:text-gray-900 mt-4 break-all transition-colors duration-700"
                            >
                                jonaykb@gmail.com
                            </h3>
                        </div>
                        <button
                            aria-label="Copy Email"
                            id="copy-email"
                            class="mt-8 w-fit px-6 py-3 bg-white light:bg-gray-900 text-black light:text-white font-bold rounded-full hover:bg-indigo-500 light:hover:bg-indigo-600 hover:text-white transition-all duration-500 flex items-center gap-2 group/btn shadow-lg"
                        >
                            <span data-i18n="contact_copy"></span>
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                class="w-4 h-4 group-hover/btn:rotate-12 transition-transform"
                                fill="none"
                                viewBox="0 0 24 24"
                                stroke="currentColor"
                            >
                                <path
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    stroke-width="2"
                                    d="M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2"
                                ></path>
                            </svg>
                        </button>
                    </div>
                </div>

                <div class="grid grid-cols-2 md:grid-cols-1 gap-6">
                    <a
                        id="ga-github"
                        href="https://github.com/jonaykb"
                        target="_blank"
                        class="flex items-center gap-4 p-6 bg-white/5 light:bg-white border border-white/10 light:border-black/5 rounded-2xl hover:bg-white/10 light:hover:bg-gray-50 transition-all duration-700 group light:shadow-sm"
                    >
                        <img
                            alt="GitHub Logo"
                            src="https://cdn.simpleicons.org/github/white"
                            class="w-6 h-6 opacity-50 light:invert light:opacity-80 group-hover:opacity-100 transition-all duration-700"
                        />
                        <span class="text-white light:text-gray-900 font-medium transition-colors duration-700">GitHub</span>
                    </a>

                    <a
                        id="ga-linkedin"
                        href="https://linkedin.com/in/jonay-contreras-rodriguez/"
                        target="_blank"
                        class="flex items-center gap-4 p-6 bg-white/5 light:bg-white border border-white/10 light:border-black/5 rounded-2xl hover:bg-[#0077B5]/20 light:hover:bg-[#0077B5]/10 hover:border-[#0077B5]/50 transition-all duration-700 group light:shadow-sm"
                    >
                        <img
                            alt="LinkedIn Logo"
                            src="https://uxwing.com/wp-content/themes/uxwing/download/brands-and-social-media/linkedin-app-white-icon.png"
                            class="w-6 h-6 opacity-50 light:brightness-0 group-hover:opacity-100 transition-all duration-700"
                        />
                        <span class="text-white light:text-gray-900 font-medium transition-colors duration-700">LinkedIn</span>
                    </a>

                    <a
                        id="ga-instagram"
                        href="https://instagram.com/jonaykb_"
                        target="_blank"
                        class="flex items-center gap-4 p-6 bg-white/5 light:bg-white border border-white/10 light:border-black/5 rounded-2xl hover:bg-pink-500/10 hover:border-pink-500/50 transition-all duration-700 group light:shadow-sm"
                    >
                        <img
                            alt="Instagram Logo"
                            src="https://cdn.simpleicons.org/instagram/white"
                            class="w-6 h-6 opacity-50 light:invert light:opacity-80 group-hover:opacity-100 transition-all duration-700"
                        />
                        <span class="text-white light:text-gray-900 font-medium transition-colors duration-700">Instagram</span>
                    </a>

                    <button
                        aria-label="Copy Phone Number"
                        id="copy-phone"
                        class="flex items-center gap-4 p-6 bg-indigo-500/10 light:bg-indigo-600/5 border border-indigo-500/30 light:border-indigo-600/20 rounded-2xl hover:bg-indigo-500/20 light:hover:bg-indigo-600/10 transition-all duration-700 cursor-pointer group w-full"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            class="w-6 h-6 text-indigo-400 light:text-indigo-600 transition-colors duration-700"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"
                            ></path>
                        </svg>
                        <span
                            id="phone-text"
                            class="text-white light:text-gray-900 font-medium font-mono transition-colors duration-700"
                            >+34 648 74 23 61</span
                        >
                    </button>
                </div>
            </div>

            <div
                class="mt-20 pt-8 border-t border-white/5 light:border-black/5 flex flex-col md:flex-row justify-between items-center gap-4 transition-colors duration-700"
            >
                <p class="text-gray-600 light:text-gray-400 text-[10px] uppercase tracking-widest transition-colors duration-700">
                    © 2025 JonayKB — Made with Astro & Tailwind
                </p>
                <div class="flex gap-8">
                    <span
                        class="text-gray-600 light:text-gray-400 text-[10px] uppercase tracking-widest transition-colors duration-700"
                        >Local Time: <span id="local-time" class="light:text-gray-500 transition-colors duration-700">--:--</span></span
                    >
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    import { translate } from "../i18n";

    const trackGAEvent = (eventName: string, label: string) => {
        if (
            typeof window !== "undefined" &&
            typeof window.gtag === "function"
        ) {
            window.gtag("event", eventName, {
                event_category: "Contact",
                event_label: label,
            });
        } else {
            console.warn(
                `GA no disponible. Evento: ${eventName}, Label: ${label}`,
            );
        }
    };

    // --- Lógica de Copiado (Email y Teléfono) ---

    const setupCopy = (btnId: string, textId: string, gaLabel: string) => {
        const btn = document.getElementById(btnId);
        const text = document.getElementById(textId)?.innerText;

        btn?.addEventListener("click", () => {
            if (text) {
                navigator.clipboard.writeText(text);
                trackGAEvent("copy_contact_info", gaLabel);

                const originalContent = btn.innerHTML;

                btn.classList.add(
                    "!bg-green-600",
                    "!text-white",
                    "pointer-events-none",
                );
                btn.innerText = translate("copied");

                setTimeout(() => {
                    btn.innerHTML = originalContent;
                    btn.classList.remove(
                        "!bg-green-600",
                        "!text-white",
                        "pointer-events-none",
                    );
                }, 2000);
            }
        });
    };

    setupCopy("copy-email", "email-text", "Email");
    setupCopy("copy-phone", "phone-text", "Phone");

    // --- Lógica de Rastreo de Redes Sociales ---
    const socialLinks = [
        { id: "ga-github", label: "GitHub" },
        { id: "ga-linkedin", label: "LinkedIn" },
        { id: "ga-instagram", label: "Instagram" },
    ];

    socialLinks.forEach((link) => {
        document.getElementById(link.id)?.addEventListener("click", () => {
            trackGAEvent("social_click", link.label);
        });
    });

    // --- Lógica Reloj Local ---
    function updateTime() {
        const timeEl = document.getElementById("local-time");
        if (timeEl) {
            const now = new Date();
            timeEl.innerText = now.toLocaleTimeString("es-ES", {
                hour: "2-digit",
                minute: "2-digit",
            });
        }
    }
    setInterval(updateTime, 1000);
    updateTime();
</script>
